# Verification Loop Skill

Claude Code セッションのための包括的な検証システムです。

## 使用タイミング

以下のタイミングでこのスキルを呼び出してください：

* 機能の実装や大幅なコード変更の完了後
* プルリクエスト（PR）作成前
* 品質ゲートを確実に通過させたい時
* リファクタリングの後

## 検証フェーズ

### フェーズ 1: ビルド検証

```bash
# プロジェクトがビルド可能か確認
npm run build 2>&1 | tail -20
# または
pnpm build 2>&1 | tail -20

```

ビルドに失敗した場合は、続行する前に停止して修正してください。

### フェーズ 2: 型チェック

```bash
# TypeScript プロジェクト
npx tsc --noEmit 2>&1 | head -30

# Python プロジェクト
pyright . 2>&1 | head -30

```

すべての型エラーを報告してください。重要なエラーは続行前に修正します。

### フェーズ 3: リンターチェック

```bash
# JavaScript/TypeScript
npm run lint 2>&1 | head -30

# Python
ruff check . 2>&1 | head -30

```

### フェーズ 4: テストスイート

```bash
# カバレッジ付きでテストを実行
npm run test -- --coverage 2>&1 | tail -50

# カバレッジのしきい値を確認
# 目標: 最低 80%

```

報告内容：

* 総テスト数: X
* 合格: X
* 失敗: X
* カバレッジ: X%

### フェーズ 5: セキュリティスキャン

```bash
# シークレットの混入を確認
grep -rn "sk-" --include="*.ts" --include="*.js" . 2>/dev/null | head -10
grep -rn "api_key" --include="*.ts" --include="*.js" . 2>/dev/null | head -10

# console.log の残存を確認
grep -rn "console.log" --include="*.ts" --include="*.tsx" src/ 2>/dev/null | head -10

```

### フェーズ 6: 差分（Diff）レビュー

```bash
# 変更内容を表示
git diff --stat
git diff HEAD~1 --name-only

```

変更された各ファイルを以下の観点でレビューします：

* 意図しない変更
* エラーハンドリングの欠如
* 潜在的なエッジケース

## 出力形式

すべてのフェーズを実行後、検証レポートを作成します：

```
検証レポート (VERIFICATION REPORT)
================================

ビルド:     [合格/不合格]
型チェック: [合格/不合格] (X 個のエラー)
リンター:   [合格/不合格] (X 個の警告)
テスト:     [合格/不合格] (X/Y 合格、カバレッジ Z%)
セキュリティ: [合格/不合格] (X 個の問題)
差分:       [X 個のファイルを変更]

総合評価:   [PR作成可能/未完了]

修正が必要な事項:
1. ...
2. ...

```

## 継続モード

長時間のセッションでは、15分ごと、または大きな変更のたびに検証を実行してください：

**チェックポイントの設定：**

* 各関数の完成後
* コンポーネントの実装後
* 次のタスクに移る前

実行： `/verify`

---

**忘れないでください**: 検証ループは開発の「品質保証」です。ビルドエラーやテストの失敗を見逃すと、後の工程でより大きなコストがかかります。常に「Ready for PR」の状態を目指しましょう。