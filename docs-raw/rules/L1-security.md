# Security Guidelines

## 必須のセキュリティチェック

コミットを行う前には、いかなる場合も以下を確認すること：

- [ ] ハードコードされたシークレット（APIキー、パスワード、トークン）がないこと
- [ ] すべてのユーザー入力が検証されていること
- [ ] SQLインジェクションの防止（パラメータ化されたクエリ）
- [ ] XSSの防止（サニタイズされたHTML）
- [ ] CSRF保護が有効であること
- [ ] 認証/認可が確認されていること
- [ ] すべてのエンドポイントにレート制限が設定されていること
- [ ] エラーメッセージから機密データが漏洩していないこと

## シークレット管理

```typescript
// 不可：ハードコードされたシークレット
const apiKey = "sk-proj-xxxxx"

// 推奨：環境変数
const apiKey = process.env.OPENAI_API_KEY

if (!apiKey) {
  throw new Error('OPENAI_API_KEY not configured')
}

```

## セキュリティレスポンスプロトコル

セキュリティ上の問題が発見された場合：

1. 直ちに停止する
2. **security-reviewer** エージェントを使用する
3. 続行する前に「致命的（CRITICAL）」な問題を修正する
4. 露出したシークレットをすべてローテーション（更新）する
5. 同様の問題がないか、コードベース全体をレビューする